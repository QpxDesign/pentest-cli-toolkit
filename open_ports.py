import sys
import subprocess 
import shlex

if len(sys.argv) < 2:
    print("ERROR - No IP Address Included")
    quit()

ports_to_check = [21, 22, 25, 53, 80, 443, 3306]
ip = sys.argv[1]

open_ports = []
for port in ports_to_check:
    command = f"telnet {ip} {port}"
    try:
        telnet_process = subprocess.Popen(shlex.split(command), stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        telnet_output, telnet_error = telnet_process.communicate(timeout=.5) 
        output_str = telnet_output.decode('utf-8')
        if "Connected" in output_str:
            open_ports.append(port)
            telnet_process.kill()
    except:
        continue

print("==================")
print("Open Ports:")
for port in open_ports:
    if port == 21:
        print("Port 21 - FTP")
    if port == 22:
        print("Port 22 - SSH")
    if port == 25:
        print("Port 25 - SMTP")
    if port == 53:
        print("Port 53 - DNS")
    if port == 80:
        print("Port 80 - HTTP")
    if port == 443:
        print("Port 443 - HTTPS")
    if port == 3306:
        print("Port 3306 - MySQL")
print("==================")